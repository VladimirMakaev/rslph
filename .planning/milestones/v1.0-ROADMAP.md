# Milestone v1.0: MVP

**Status:** SHIPPED 2026-01-19
**Phases:** 1-6
**Total Plans:** 17

## Overview

Build rslph from foundation to polished CLI/TUI — an autonomous AI coding agent that reads a plan, breaks it into tasks, and iteratively executes them using Claude. Each iteration starts with fresh context, preventing context pollution while preserving learnings through a progress file.

## Phases

### Phase 1: Foundation
**Goal**: Core infrastructure — config loads correctly, CLI parses commands, progress files can be read and written atomically
**Depends on**: Nothing (first phase)
**Plans**: 3/3 complete

Plans:
- [x] 01-01-PLAN.md — Config system (TOML loading, defaults, validation)
- [x] 01-02-PLAN.md — CLI parser (clap, subcommands, argument merging)
- [x] 01-03-PLAN.md — Progress file parser/writer (markdown format, atomic writes)

**Key accomplishments:**
- TOML config with figment-based layered precedence (defaults < file < env < CLI)
- XDG-compliant paths (`~/.config/rslph/config.toml`)
- Complete progress file parser with all sections

### Phase 2: Subprocess Management
**Goal**: Claude CLI can be spawned, output streamed in real-time, and process lifecycle managed safely
**Depends on**: Phase 1
**Plans**: 2/2 complete

Plans:
- [x] 02-01-PLAN.md — Subprocess spawning and streaming (ClaudeRunner struct, piped I/O)
- [x] 02-02-PLAN.md — Signal handling and timeout management (CancellationToken, graceful shutdown)

**Key accomplishments:**
- Async subprocess with concurrent stdout/stderr streaming
- Graceful Ctrl+C handling with CancellationToken
- Configurable timeout for stuck Claude invocations

### Phase 3: Planning Command
**Goal**: `rslph plan` transforms ideas into structured progress files, with optional adaptive mode
**Depends on**: Phase 2
**Plans**: 2/2 complete

Plans:
- [x] 03-01-PLAN.md — Basic planning mode (prompt system, stack detection, Claude execution)
- [x] 03-02-PLAN.md — Adaptive mode (vagueness detection, personas, multi-turn conversation)

**Key accomplishments:**
- Baked-in prompts via include_str! (zero runtime cost)
- Stack detection for Rust, Node/TypeScript, Python, Go
- Adaptive mode with vagueness scoring and clarifying questions
- Multi-persona conversation (requirements clarifier, testing strategist)

### Phase 4: Core Build Loop
**Goal**: `rslph build` executes tasks iteratively with fresh context, completion detection
**Depends on**: Phase 3
**Plans**: 4/4 complete

Plans:
- [x] 04-01-PLAN.md — Build module foundation (state machine, PROMPT_build, iteration logic)
- [x] 04-02-PLAN.md — Completion detection and loop termination (RALPH_DONE, max iterations)
- [x] 04-03-PLAN.md — Single iteration and dry-run modes (--once, --dry-run)
- [x] 04-04-PLAN.md — Fix claude_path resolution for subprocess spawn

**Key accomplishments:**
- Enum state machine (Starting, Running, IterationComplete, Done, Failed)
- Fresh Claude subprocess per iteration
- RALPH_DONE marker detection for early termination
- Recent attempts section for failure memory
- --once and --dry-run modes

### Phase 5: VCS Integration
**Goal**: Each iteration auto-commits for rollback safety, supporting both Git and Sapling
**Depends on**: Phase 4
**Plans**: 2/2 complete

Plans:
- [x] 05-01-PLAN.md — VCS module with Git/Sapling implementations, auto-detection, build loop integration
- [x] 05-02-PLAN.md — Fix commit message project name and Sapling hash retrieval

**Key accomplishments:**
- Trait-based VCS abstraction with Git and Sapling implementations
- Auto-detection (Sapling via `sl root`, Git via `.git` directory)
- Descriptive commit messages with project name and iteration number
- VCS errors warn but don't fail the build

### Phase 6: TUI Interface
**Goal**: Rich terminal UI displays status, live output, and collapsible conversation threads
**Depends on**: Phase 4
**Plans**: 4/4 complete

Plans:
- [x] 06-01-PLAN.md — Terminal setup, panic hooks, app state, event handler
- [x] 06-02-PLAN.md — Status bar header and progress bar widgets
- [x] 06-03-PLAN.md — Live output view with scrolling and ClaudeRunner channel integration
- [x] 06-04-PLAN.md — Thread view, keyboard navigation, build command integration

**Key accomplishments:**
- Ratatui-based TUI with 30 FPS render rate
- Status bar with iteration count, task count, context usage progress bar
- Role-styled messages (Claude CLI-like display)
- Keyboard navigation: j/k scroll, {/} iteration, p pause, q quit
- Log routing through TUI channel to prevent display corruption
- --no-tui flag for headless operation

---

## Milestone Summary

**Key Decisions:**
- CFG-ENV-LOWERCASE: Use lowercase env var mapping for flat config structure
- PROMPT-INCLUDE-STR: Use include_str! for compile-time prompt embedding
- CLAUDE-HEADLESS-P: Use -p flag for headless Claude CLI execution
- VCS-SAPLING-FIRST: Detect Sapling via sl root before Git via .git directory
- TUI-STDERR-BACKEND: Use stderr for terminal backend to keep stdout available
- TUI-LOG-ROUTING: Route logs through TUI channel when active

**Issues Resolved:**
- Fixed context overflow with stream-json parsing
- Fixed VCS commit message project name extraction
- Fixed Sapling hash retrieval via `sl log` template
- Fixed TUI display corruption via log routing

**Issues Deferred:**
- Phase 7 (Verification) — moved to v1.1
- Phase 8 (Notifications and Polish) — moved to v1.1
- CLAUDE-INTERNET-FLAG workaround still in place

**Technical Debt:**
- --internet flag workaround for Claude CLI hanging
- Need to research --output-format stream-json and --json-schema flags

---

*For current project status, see .planning/ROADMAP.md*
