---
phase: 14-tui-visual-parity
plan: 03
type: execute
wave: 2
depends_on: ["14-01"]
files_modified:
  - src/tui/widgets/status_bar.rs
  - src/tui/app.rs
autonomous: true

must_haves:
  truths:
    - "Status bar shows model tier indicator (diamond/circle symbol)"
    - "Status bar displays session timer (HH:MM:SS or MM:SS format)"
    - "Token usage bar shows with themed colors"
    - "Model tier correctly identifies opus/sonnet/haiku variants"
  artifacts:
    - path: "src/tui/widgets/status_bar.rs"
      provides: "Enhanced status bar with tier, timer, tokens"
      contains: "session_start"
    - path: "src/tui/app.rs"
      provides: "session_start: Instant field"
      contains: "session_start"
  key_links:
    - from: "src/tui/widgets/status_bar.rs"
      to: "src/tui/theme.rs"
      via: "theme::symbols::model_tier_indicator import"
      pattern: "model_tier_indicator"
---

<objective>
Enhance the status bar with model tier indicator, session timer, and improved token display.

Purpose: Provide richer status information matching Claude Code's interface. Users see at-a-glance model tier (Opus/Sonnet/Haiku), elapsed session time, and token consumption.

Output: Enhanced status_bar.rs with tier symbols and timer, updated App with session_start.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/14-tui-visual-parity-with-claude-code/14-RESEARCH.md
@.planning/phases/14-tui-visual-parity-with-claude-code/14-01-SUMMARY.md
@src/tui/theme.rs
@src/tui/widgets/status_bar.rs
@src/tui/app.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add session_start to App</name>
  <files>src/tui/app.rs</files>
  <action>
Modify App struct in src/tui/app.rs:

1. Add import at top:
   `use std::time::Instant;`

2. Add new field to App struct (in status bar state section):
   ```rust
   /// Session start time for elapsed display.
   pub session_start: Instant,
   ```

3. Initialize in Default impl:
   ```rust
   session_start: Instant::now(),
   ```

This tracks when the TUI session started for the session timer display.
  </action>
  <verify>
`cargo check` succeeds.
`grep -n "session_start" src/tui/app.rs` shows field definition.
  </verify>
  <done>App has session_start: Instant field initialized to Instant::now()</done>
</task>

<task type="auto">
  <name>Task 2: Enhance status bar with tier indicator and timer</name>
  <files>src/tui/widgets/status_bar.rs</files>
  <action>
Modify src/tui/widgets/status_bar.rs:

1. Add imports:
   ```rust
   use std::time::Instant;
   use crate::tui::theme::symbols::model_tier_indicator;
   ```

2. Add helper function for session time formatting:
   ```rust
   /// Format elapsed session time as HH:MM:SS or MM:SS.
   fn format_session_time(start: Instant) -> String {
       let elapsed = start.elapsed();
       let secs = elapsed.as_secs();
       let mins = secs / 60;
       let hours = mins / 60;

       if hours > 0 {
           format!("{:02}:{:02}:{:02}", hours, mins % 60, secs % 60)
       } else {
           format!("{:02}:{:02}", mins, secs % 60)
       }
   }
   ```

3. Update render_branding_line to include model tier:
   - Get tier symbol using `model_tier_indicator(&app.model_name)`
   - Format right side as: `{tier} {model_name} | {session_time}`
   - Style the tier indicator with appropriate color (Crail for opus, default otherwise)

4. The branding line should show:
   - Left: "rslph" (bold)
   - Right: "◆ claude-opus-4 | 05:23" or "◇ claude-sonnet-4 | 03:15"

Keep the existing status line (iteration, task, tokens) unchanged.
  </action>
  <verify>
`cargo check` succeeds.
`grep -n "model_tier_indicator" src/tui/widgets/status_bar.rs` shows usage.
`grep -n "format_session_time" src/tui/widgets/status_bar.rs` shows function.
  </verify>
  <done>Status bar displays model tier symbol and session timer in branding line</done>
</task>

</tasks>

<verification>
```bash
# Check compilation
cargo check

# Verify App changes
grep -n "session_start" src/tui/app.rs
grep -n "Instant" src/tui/app.rs

# Verify status bar changes
grep -n "model_tier_indicator" src/tui/widgets/status_bar.rs
grep -n "format_session_time" src/tui/widgets/status_bar.rs

# Check theme import
grep -n "use crate::tui::theme" src/tui/widgets/status_bar.rs
```
</verification>

<success_criteria>
1. App struct has session_start: Instant field
2. session_start initialized to Instant::now() in Default impl
3. status_bar.rs imports model_tier_indicator from theme
4. format_session_time helper function exists and formats HH:MM:SS or MM:SS
5. Branding line shows tier indicator (◆/◇/○) before model name
6. Branding line shows session timer after model name
7. `cargo build` succeeds with no warnings
</success_criteria>

<output>
After completion, create `.planning/phases/14-tui-visual-parity-with-claude-code/14-03-SUMMARY.md`
</output>
