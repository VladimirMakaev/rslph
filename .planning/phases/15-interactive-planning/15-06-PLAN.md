---
phase: 15-interactive-planning
plan: 06
type: execute
wave: 1
depends_on: []
files_modified:
  - prompts/gsd/PROMPT_plan.md
  - prompts/gsd_tdd/PROMPT_plan.md
  - prompts/basic/PROMPT_plan.md
  - prompts/PROMPT_plan.md
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Prompts allow questions when adaptive mode is enabled"
    - "Prompts still discourage questions in non-adaptive mode"
    - "AskUserQuestion tool usage is documented in prompts"
  artifacts:
    - path: "prompts/gsd/PROMPT_plan.md"
      provides: "Modified guideline allowing questions in adaptive mode"
      contains: "AskUserQuestion"
    - path: "prompts/gsd_tdd/PROMPT_plan.md"
      provides: "Modified guideline allowing questions in adaptive mode"
      contains: "AskUserQuestion"
    - path: "prompts/basic/PROMPT_plan.md"
      provides: "Modified guideline allowing questions in adaptive mode"
      contains: "AskUserQuestion"
  key_links:
    - from: "prompts/*/PROMPT_plan.md"
      to: "Claude's AskUserQuestion tool"
      via: "Instruction in planning guidelines"
      pattern: "AskUserQuestion"
---

<objective>
Modify planning prompts to allow clarifying questions in adaptive mode

Purpose: The root cause of all 6 UAT failures is that prompts contain "Do NOT ask clarifying questions" which prevents Claude from ever using the AskUserQuestion tool. This plan modifies prompts to conditionally allow questions when the user opts into adaptive mode.

Output: Updated prompt files that encourage questions in adaptive mode while preserving current behavior for non-adaptive mode.
</objective>

<execution_context>
@/Users/vmakaev/.claude/get-shit-done/workflows/execute-plan.md
@/Users/vmakaev/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/15-interactive-planning/15-GAP-RESEARCH.md
@.planning/phases/15-interactive-planning/15-UAT.md

# Current prompts to modify
@prompts/gsd/PROMPT_plan.md
@prompts/gsd_tdd/PROMPT_plan.md
@prompts/basic/PROMPT_plan.md
@prompts/PROMPT_plan.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Modify GSD planning prompt to allow questions</name>
  <files>prompts/gsd/PROMPT_plan.md</files>
  <action>
Find line 177 which currently says:
```
7. Do NOT ask clarifying questions - make reasonable assumptions
```

Replace it with:
```
7. **Clarifying Questions:**
   - In **standard mode** (default): Make reasonable assumptions rather than asking questions. Document assumptions in the Analysis section.
   - In **adaptive mode** (`--adaptive` flag): You MAY use the `AskUserQuestion` tool to gather critical missing information before generating the plan. Use this for:
     * Ambiguous technology choices (e.g., "What database: PostgreSQL or MongoDB?")
     * Critical scope decisions (e.g., "Should auth include OAuth or just email/password?")
     * Project-specific context (e.g., "What's the target deployment environment?")
   - Keep questions focused and minimal (2-5 questions max). Don't ask about obvious or easily-defaulted choices.
```

This change:
- Preserves default behavior (no questions)
- Enables questions only in adaptive mode
- Provides guidance on what kinds of questions are appropriate
- Limits question count to avoid over-questioning
  </action>
  <verify>grep -A 10 "Clarifying Questions" prompts/gsd/PROMPT_plan.md</verify>
  <done>GSD planning prompt contains updated clarifying questions guideline with adaptive mode support and AskUserQuestion reference</done>
</task>

<task type="auto">
  <name>Task 2: Modify GSD-TDD and Basic planning prompts</name>
  <files>prompts/gsd_tdd/PROMPT_plan.md, prompts/basic/PROMPT_plan.md, prompts/PROMPT_plan.md</files>
  <action>
Apply the same modification to the other planning prompts.

**prompts/gsd_tdd/PROMPT_plan.md** (around line 170):
Find:
```
7. Do NOT ask clarifying questions - make reasonable assumptions
```
Replace with the same expanded guideline from Task 1.

**prompts/basic/PROMPT_plan.md** (around line 86):
Find:
```
7. Do NOT ask clarifying questions - make reasonable assumptions
```
Replace with the same expanded guideline from Task 1.

**prompts/PROMPT_plan.md** (around line 86):
Find:
```
7. Do NOT ask clarifying questions - make reasonable assumptions
```
Replace with the same expanded guideline from Task 1.

Note: The PROMPT_plan.md in the root prompts/ directory is the fallback/default. All four files should have consistent behavior.
  </action>
  <verify>for f in prompts/*/PROMPT_plan.md prompts/PROMPT_plan.md; do echo "=== $f ===" && grep -c "AskUserQuestion" "$f"; done</verify>
  <done>All four planning prompts (gsd, gsd_tdd, basic, root) contain the updated clarifying questions guideline with AskUserQuestion reference</done>
</task>

</tasks>

<verification>
1. `grep "Do NOT ask clarifying questions" prompts/*/PROMPT_plan.md` returns no matches (old text removed)
2. `grep "AskUserQuestion" prompts/*/PROMPT_plan.md` returns matches in all prompt files
3. Prompts still contain "standard mode" text preserving default behavior
4. Prompts contain "adaptive mode" text enabling questions
</verification>

<success_criteria>
- All planning prompts have the updated clarifying questions guideline
- "AskUserQuestion" appears in all modified prompts
- "adaptive mode" appears in all modified prompts
- Original "Do NOT ask clarifying questions" line is replaced (not present)
- Default behavior (no questions) is preserved for non-adaptive mode
</success_criteria>

<output>
After completion, create `.planning/phases/15-interactive-planning/15-06-SUMMARY.md`
</output>
